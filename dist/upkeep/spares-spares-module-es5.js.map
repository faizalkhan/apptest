{"version":3,"sources":["webpack:///src/app/spares/spares.module.ts","webpack:///src/app/spares/order-basket/order-basket.component.ts","webpack:///src/app/spares/order-basket/order-basket.component.html","webpack:///src/app/spares/stock-list/sku-stock/sku-stock.component.ts","webpack:///src/app/spares/stock-list/sku-stock/sku-stock.component.html","webpack:///src/app/spares/stock-list/spares-group/spares-group.component.ts","webpack:///src/app/spares/stock-list/spares-group/spares-group.component.html","webpack:///src/app/spares/order-history/order-history.component.ts","webpack:///src/app/spares/order-history/order-history.component.html","webpack:///src/app/spares/spares-routing.module.ts","webpack:///src/app/services/order/order.service.ts","webpack:///src/utils/numberUtils.ts","webpack:///src/app/spares/order-basket/basket-item/basket-item.component.ts","webpack:///src/app/spares/order-basket/basket-item/basket-item.component.html","webpack:///src/app/spares/stock-list/stock-list.component.ts","webpack:///src/app/spares/stock-list/stock-list.component.html"],"names":["SparesModule","OrderBasketComponent","basketService","authenticationService","toastService","orderService","router","userService","numberToPriceString","isPlacingOrder","isGettingBasket","basket$","subscribe","basket","items","setPermissionBooleans","currentUserHasPermission","Spares","CanPlaceOrder","hasPermission","canPlaceOrder","CanViewOrderHistory","canViewOrderHistory","errorMessage","requestOrder","primaryOrganisationId","_","showToast","getBasket","pipe","next","navigate","errorResponse","error","showErrorToast","placeOrder","SkuStockComponent","visuallyExpanded","detailsModalVisible","isAddingToBasket","qty","isQtyInOrderMultiples","canAddToBasket","userProfile","currentUserProfile$","getValue","skuStock","quantities","minimumOrderQuantity","addToBasketSubscription","basketItem","createdByUserId","userId","createdByUserName","name","skuId","id","skuDescription","description","uom","addToBasket","primarySite","event","preventDefault","e","key","isNaN","keyCode","toString","length","handleAddToBasket","handleOrderMoreClick","SparesGroupComponent","skuService","elementRef","skuStocks","offset","takeSize","shouldGetNextSkuStocks","isGettingNextSkuStocks","getNextSkuStocks","setMaxHeight","getSkuStockForSparesGroup","sparesGroup","groupId","subGroupId","siteId","textFilter","skus","push","handleSkuStockHeightChanged","setTimeout","children","nativeElement","totalHeight","child","getBoundingClientRect","height","maxHeight","handleRowToggleClick","OrderHistoryComponent","stockListRequiredPermissions","CanViewStockList","basketRequiredPermissions","CanAddToBasket","orderViewRequiredPermissions","routes","path","component","canActivate","data","permissionsRequired","SparesRoutingModule","forChild","OrderService","httpClient","orderUrl","apiBaseUrl","organisationId","map","item","requestedByUserId","requestedByUserName","orderLink","concat","payload","currentUserProfile","approvedByUserId","approvedByUserName","approvedByEmailId","emailAddress","post","commaSeperatedNumberString","number","numberString","toFixed","lastThreeAndDecimalValues","substring","otherNumbers","replace","price","currencyGlyph","dropThePennies","prefix","priceString","Math","floor","numberToPriceStringNoGlyph","randomInt","min","max","random","numberToWords","value","units","tens","num","Number","n","substr","match","str","toUpperCase","BasketItemComponent","formBuilder","itemActionInProgress","quantityChangeModalVisible","isGettingSkuInfo","isUpdatingQty","isCurrentUserManager","isRequestedUser","skuInfoSubscription","CanModifyBasket","canModifyBasket","currentUserIsManager","isManager","currentUserId","deleteBasketItem","x","qtyForm","group","required","getSkuStockForSkuId","sku","updateBasketItem","handleUpdateQty","qtyStringExceedsMaxLength","valid","handleDeleteItem","StockListComponent","isLoading","allProductClassesOption","sparesGroups","searchForm","text","getSparesGroupSubscription","getSparesGroups","undefined","err","get","valueChanges","textValue","submitSearch","unsubscribe"],"mappings":"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","file":"spares-spares-module-es5.js","sourcesContent":["import { CommonModule } from '@angular/common';\r\nimport { NgModule } from '@angular/core';\r\nimport { ReactiveFormsModule } from '@angular/forms';\r\nimport { SharedModule } from '../shared-module/shared-module.module';\r\nimport { SparesRoutingModule } from './spares-routing.module';\r\nimport { StockListComponent } from './stock-list/stock-list.component';\r\nimport { SparesGroupComponent } from './stock-list/spares-group/spares-group.component';\r\nimport { SkuStockComponent } from './stock-list/sku-stock/sku-stock.component';\r\nimport { OrderBasketComponent } from './order-basket/order-basket.component';\r\nimport { BasketItemComponent } from './order-basket/basket-item/basket-item.component';\r\nimport { OrderHistoryComponent } from './order-history/order-history.component';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    ReactiveFormsModule,\r\n    SharedModule,\r\n    SparesRoutingModule\r\n  ],\r\n  declarations: [\r\n    StockListComponent,\r\n    SparesGroupComponent,\r\n    SkuStockComponent,\r\n    OrderBasketComponent,\r\n    BasketItemComponent,\r\n    OrderHistoryComponent\r\n  ],\r\n  providers: []\r\n})\r\nexport class SparesModule {}\r\n","import { Component, OnInit } from '@angular/core';\r\nimport { Basket } from 'src/app/services/basket/basket.types';\r\nimport { numberToPriceString } from '../../../../src/utils/numberUtils';\r\nimport {\r\n  AuthenticationService,\r\n  BasketService,\r\n  PermissionGroup,\r\n  SparesPermissions,\r\n  Toast,\r\n  ToastService\r\n} from 'src/app/services';\r\nimport { OrderService } from 'src/app/services/order/order.service';\r\nimport { take } from 'rxjs/operators';\r\nimport { Router } from '@angular/router';\r\nimport { HttpErrorResponse } from '@angular/common/http';\r\nimport { UserService } from 'src/app/services/user-account/user.service';\r\n\r\n@Component({\r\n  selector: 'app-order-basket',\r\n  templateUrl: './order-basket.component.html',\r\n  styleUrls: ['./order-basket.component.scss']\r\n})\r\nexport class OrderBasketComponent implements OnInit {\r\n  public basket: Basket;\r\n  public numberToPriceString = numberToPriceString;\r\n  public isPlacingOrder = false;\r\n  public errorMessage: string;\r\n  public canPlaceOrder: boolean;\r\n  public canViewOrderHistory: boolean;\r\n  public isGettingBasket = false;\r\n\r\n  constructor(\r\n    private basketService: BasketService,\r\n    private authenticationService: AuthenticationService,\r\n    private toastService: ToastService,\r\n    private orderService: OrderService,\r\n    private router: Router,\r\n    private userService: UserService\r\n  ) {}\r\n\r\n  public ngOnInit() {\r\n    this.isGettingBasket = true;\r\n    this.basketService.basket$.subscribe((basket: Basket) => {\r\n      this.isGettingBasket = false;\r\n      if (basket && basket.items) {\r\n        this.basket = basket;\r\n      }\r\n    });\r\n    this.setPermissionBooleans();\r\n  }\r\n\r\n  private setPermissionBooleans() {\r\n    this.authenticationService\r\n      .currentUserHasPermission({\r\n        [PermissionGroup.Spares]: [SparesPermissions.CanPlaceOrder]\r\n      })\r\n      .subscribe(hasPermission => (this.canPlaceOrder = hasPermission));\r\n\r\n    this.authenticationService\r\n      .currentUserHasPermission({\r\n        [PermissionGroup.Spares]: [SparesPermissions.CanViewOrderHistory]\r\n      })\r\n      .subscribe(hasPermission => (this.canViewOrderHistory = hasPermission));\r\n  }\r\n\r\n  public placeOrder() {\r\n    if (this.isPlacingOrder) {\r\n      return;\r\n    }\r\n    this.isPlacingOrder = true;\r\n    this.errorMessage = '';\r\n\r\n    this.orderService\r\n      .requestOrder(this.basket, this.userService.primaryOrganisationId)\r\n      .subscribe(\r\n        _ => {\r\n          this.isPlacingOrder = false;\r\n          this.toastService.showToast(\r\n            new Toast('Request details emailed to purchase team')\r\n          );\r\n          this.basketService\r\n            .getBasket()\r\n            .pipe(take(1))\r\n            .subscribe(basket => {\r\n              this.basketService.basket$.next(new Basket(basket));\r\n            });\r\n          this.router.navigate(['spares/stock-list']);\r\n        },\r\n        (errorResponse: HttpErrorResponse) => {\r\n          this.isPlacingOrder = false;\r\n          const errorMessage = errorResponse.error;\r\n          this.toastService.showErrorToast(errorMessage);\r\n          return;\r\n        },\r\n        () => {\r\n          this.isPlacingOrder = false;\r\n          this.errorMessage = `Sorry something went wrong... please try again later`;\r\n        }\r\n      );\r\n  }\r\n\r\n  public handlesPlaceOrderClick() {\r\n    if (this.isPlacingOrder) {\r\n      return;\r\n    }\r\n    this.placeOrder();\r\n  }\r\n}\r\n","<app-section-header></app-section-header>\r\n\r\n<h2>\r\n  Order Basket\r\n</h2>\r\n<div *ngIf=\"isGettingBasket\" class=\"spinner light\"></div>\r\n<div *ngIf=\"!basket && !isGettingBasket || basket.items.length === 0 && !isGettingBasket\" class=\"text-center\">\r\n  Your basket is empty\r\n  <div class=\"row\">\r\n    <div class=\"col-md-4 offset-md-4\">\r\n      <a class=\"btn add-btn btn-block mt-2\" routerLink=\"/product-catalogue\">\r\n        <span>Add more spares</span>\r\n      </a>\r\n    </div>\r\n  </div>\r\n</div>\r\n\r\n<div *ngIf=\"basket && basket.items.length > 0\">\r\n  <table>\r\n    <thead>\r\n      <th>ID</th>\r\n      <th><span>Description</span><span class=\"mobile-only\"> &nbsp;& Id</span></th>\r\n      <th>Order Qty</th>\r\n      <th>UOM</th>\r\n      <th>Added By</th>\r\n      <th></th>\r\n    </thead>\r\n    <tbody>\r\n      <app-basket-item *ngFor=\"let basketItem of basket.items\" [basketItem]=\"basketItem\"></app-basket-item>\r\n    </tbody>\r\n  </table>\r\n  <div *ngIf=\"errorMessage\" class=\"alert alert-danger text-center\">\r\n    {{errorMessage}}\r\n  </div>\r\n\r\n  <div class=\"actions row\">\r\n    <div class=\"col-sm-7\">\r\n      <a class=\"btn add-btn\" routerLink=\"/spares/stock-list\">\r\n        <span>Add more spares</span>\r\n      </a>\r\n    </div>\r\n    <div class=\"col-sm-5\">\r\n      <button *ngIf=\"canPlaceOrder\" (click)=\"handlesPlaceOrderClick()\" class=\"btn btn-primary btn-block\">\r\n        <span *ngIf=\"!isPlacingOrder\">Place Order</span>\r\n        <div *ngIf=\"isPlacingOrder\" class=\"spinner light\"></div>\r\n      </button>\r\n    </div>\r\n  </div>\r\n</div>\r\n","import { Component, Input, OnInit } from '@angular/core';\r\nimport {\r\n  ISkuStock,\r\n  BasketService,\r\n  ToastService,\r\n  Toast,\r\n  AuthenticationService,\r\n  UserProfile\r\n} from 'src/app/services';\r\nimport {\r\n  safelyUnsubscribeFrom,\r\n  AutoUnsubscribe\r\n} from '../../../../utils/observableUtils';\r\nimport { Subscription } from 'rxjs';\r\nimport { HttpErrorResponse } from '@angular/common/http';\r\nimport { IBasketItem } from 'src/app/services/basket/basket.types';\r\n\r\nAutoUnsubscribe;\r\n@Component({\r\n  selector: 'app-sku-stock',\r\n  templateUrl: './sku-stock.component.html',\r\n  styleUrls: ['./sku-stock.component.scss']\r\n})\r\nexport class SkuStockComponent implements OnInit {\r\n  @Input()\r\n  public skuStock: ISkuStock;\r\n  public visuallyExpanded = false;\r\n  public detailsModalVisible = false;\r\n  public isAddingToBasket = false;\r\n  public qty = 1;\r\n  public isQtyInOrderMultiples = true;\r\n  public canAddToBasket: boolean = true;\r\n  public addToBasketSubscription: Subscription;\r\n  public userProfile: UserProfile;\r\n\r\n  constructor(\r\n    private basketService: BasketService,\r\n    private toastService: ToastService,\r\n    public authenticationService: AuthenticationService\r\n  ) {\r\n    this.userProfile = this.authenticationService.currentUserProfile$.getValue();\r\n  }\r\n\r\n  public ngOnInit() {\r\n    if (this.skuStock.quantities.minimumOrderQuantity) {\r\n      this.qty = this.skuStock.quantities.minimumOrderQuantity;\r\n    }\r\n  }\r\n\r\n  public handleOrderMoreClick() {\r\n    this.detailsModalVisible = true;\r\n  }\r\n\r\n  public handleDetailsModalClose() {\r\n    this.detailsModalVisible = false;\r\n  }\r\n\r\n  public handleAddToBasket(): void {\r\n    this.isAddingToBasket = true;\r\n    safelyUnsubscribeFrom(this.addToBasketSubscription);\r\n    let basketItem: IBasketItem;\r\n\r\n    basketItem = {\r\n      createdByUserId: this.userProfile.userId,\r\n      createdByUserName: this.userProfile.name,\r\n      skuId: this.skuStock.id,\r\n      skuDescription: this.skuStock.description,\r\n      uom: this.skuStock.uom,\r\n      qty: this.qty\r\n    };\r\n\r\n    this.addToBasketSubscription = this.basketService\r\n      .addToBasket(basketItem, this.userProfile.primarySite.id)\r\n      .subscribe(\r\n        () => {\r\n          this.isAddingToBasket = false;\r\n          this.detailsModalVisible = false;\r\n          this.toastService.showToast(new Toast('Added to basket'));\r\n        },\r\n        (errorResponse: HttpErrorResponse) => {\r\n          this.isAddingToBasket = false;\r\n          const errorMessage = errorResponse.error;\r\n          this.toastService.showErrorToast(errorMessage);\r\n          return;\r\n        }\r\n      );\r\n  }\r\n\r\n  public handleQtyClipboard(event: ClipboardEvent) {\r\n    event.preventDefault();\r\n    return;\r\n  }\r\n\r\n  public disableRightClick(e) {\r\n    e.preventDefault();\r\n  }\r\n\r\n  public handleQtyInputKeyDown(event) {\r\n    if (event.key === 'Backspace' || event.key === 'Delete') {\r\n      return;\r\n    }\r\n    if (isNaN(event.key) || event.keyCode === 32) {\r\n      event.preventDefault();\r\n    }\r\n  }\r\n\r\n  public handleQtyKeyup(event: KeyboardEvent) {\r\n    if (\r\n      event.key === 'Enter' &&\r\n      this.qty > 0 &&\r\n      this.qty.toString().length > 0 &&\r\n      this.qty >= this.skuStock.quantities.minimumOrderQuantity\r\n    ) {\r\n      event.preventDefault();\r\n      this.handleAddToBasket();\r\n    }\r\n  }\r\n}\r\n","<div class=\"sku-stock\">\r\n  <div class=\"sku-stock-row\" [class.expanded]=\"visuallyExpanded\">\r\n    <div>\r\n      <strong>ID</strong>\r\n    </div>\r\n\r\n    <div class=\"id\">\r\n      {{ skuStock.id }}\r\n    </div>\r\n\r\n    <div class=\"name\">\r\n      {{ skuStock.description }}\r\n    </div>\r\n\r\n    <div class=\"stock-levels\">\r\n      <table>\r\n        <tr>\r\n          <th>In&nbsp;Stock</th>\r\n          <td>{{ skuStock.quantities.inStock }}</td>\r\n        </tr>\r\n        <tr>\r\n          <th>On&nbsp;Order</th>\r\n          <td><span style=\"display:flex\">{{ skuStock.quantities.onOrder}}\r\n            <span class=\"9\"\r\n              *ngIf=\"skuStock.quantities.onOrder.toString().length === 9\">\r\n              &nbsp;&nbsp;&nbsp;\r\n            </span>\r\n            <span class=\"8\"\r\n              *ngIf=\"skuStock.quantities.onOrder.toString().length === 8\">\r\n              &nbsp;&nbsp;&nbsp;&nbsp;\r\n            </span>\r\n            <span class=\"7\"\r\n              *ngIf=\"skuStock.quantities.onOrder.toString().length === 7\">\r\n              &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n            </span>\r\n            <span class=\"6\"\r\n              *ngIf=\"skuStock.quantities.onOrder.toString().length === 6\">\r\n              &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n            </span>\r\n            <span class=\"5\"\r\n              *ngIf=\"skuStock.quantities.onOrder.toString().length === 5\">\r\n              &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n            </span>\r\n            <span class=\"4\"\r\n              *ngIf=\"skuStock.quantities.onOrder.toString().length === 4\">\r\n              &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n            </span>\r\n            <span class=\"3\"\r\n              *ngIf=\"skuStock.quantities.onOrder.toString().length === 3\">\r\n              &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n            </span>\r\n            <span class=\"2\"\r\n              *ngIf=\" skuStock.quantities.onOrder.toString().length === 2\">\r\n              &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n            </span>\r\n            <span class=\"1\"\r\n              *ngIf=\"skuStock.quantities.onOrder.toString().length === 1\">\r\n              &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n            </span></span>\r\n          </td>\r\n        </tr>\r\n        <tr>\r\n          <th>Min Stock</th>\r\n          <td>{{ skuStock.quantities.minimumOrderQuantity }}</td>\r\n        </tr>\r\n      </table>\r\n    </div>\r\n\r\n    <div class=\"actions\">\r\n      <div>\r\n        <button (click)=\"handleOrderMoreClick()\" class=\"btn btn-link\">\r\n          Order More\r\n        </button>\r\n      </div>\r\n    </div>\r\n\r\n  </div>\r\n\r\n  <app-modal\r\n  *ngIf=\"detailsModalVisible\"\r\n  (modalShouldClose)=\"handleDetailsModalClose()\"\r\n  class=\"order-stock-sku-modal\"\r\n (contextmenu)=\"disableRightClick($event)\"\r\n  >\r\n    <article>\r\n      <section class=\"generic-info\">\r\n        <header class=\"row\">\r\n          <div class=\"col-8\">\r\n            <h1>{{skuStock.sparesGroupName}}</h1>\r\n          </div>\r\n          <div class=\"col-4 text-right\">\r\n            <strong>ID</strong> {{skuStock.id}}\r\n          </div>\r\n        </header>\r\n        <div class=\"row description-row mt-4\">\r\n          <div class=\"col-12\">\r\n            <dl>\r\n              <dt>Description</dt>\r\n              <dd>{{skuStock.description}}</dd>\r\n            </dl>\r\n          </div>\r\n        </div>\r\n      </section>\r\n      <section class=\"stock-info\">\r\n        <div class=\"row\">\r\n          <div class=\"col12\">\r\n            <h2>Order</h2>\r\n          </div>\r\n        </div>\r\n        <div class=\"info-row row\">\r\n          <div class=\"col-sm-3 col-3\">\r\n            <dl>\r\n              <dt>In stock</dt>\r\n              <dd>{{skuStock.quantities.inStock}}</dd>\r\n            </dl>\r\n          </div>\r\n          <div class=\"col-sm-5 col-6\">\r\n            <dl>\r\n              <dt>Min. Required Stock</dt>\r\n              <dd>{{skuStock.quantities.reOrderLevel}}</dd>\r\n            </dl>\r\n          </div>\r\n          <div class=\"col-sm-3 col-3\">\r\n            <dl>\r\n              <dt>Uom</dt>\r\n              <dd>{{skuStock.uom}}</dd>\r\n            </dl>\r\n          </div>\r\n        </div>\r\n        <div *ngIf=\"canAddToBasket\">\r\n          <div class=\"row notice-row\" *ngIf=\" qty < skuStock.quantities.minimumOrderQuantity \" >\r\n            <div class=\"col-12\">\r\n              <div *ngIf=\"qty < skuStock.quantities.minimumOrderQuantity\">\r\n                Please note, minimum order quantity for this product is\r\n                {{ skuStock.quantities.minimumOrderQuantity }} items.\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div class=\"row add-to-basket-row\">\r\n            <div class=\"col-4\">\r\n              <input [(ngModel)]=\"qty\" (paste)=\"handleQtyClipboard($event)\" (keydown)=\"handleQtyInputKeyDown($event)\" (keyup)=\"handleQtyKeyup($event)\"\r\n                type=\"text\" pattern=\"[0-9]*\" inputmode=\"text\" ng-pattern=\"[0-9]*\" class=\"form-control quantity-input\" maxlength=\"6\"/>\r\n            </div>\r\n            <div class=\"col-8\">\r\n              <button class=\"btn btn-primary btn-block\" [disabled]=\" qty < skuStock.quantities.minimumOrderQuantity || qty < 1 || qty.toString().length === 0\" (click)=\"handleAddToBasket()\">\r\n                <span *ngIf=\"!isAddingToBasket\">Add to Basket</span>\r\n                <div *ngIf=\"isAddingToBasket\" class=\"spinner light\"></div>\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </section>\r\n    </article>\r\n  </app-modal>\r\n","import { Component, ElementRef, Input, OnInit } from '@angular/core';\r\nimport { ISkuStock, SkuService, SparesGroup } from '../../../services';\r\n\r\n@Component({\r\n  selector: 'app-spares-group',\r\n  templateUrl: './spares-group.component.html',\r\n  styleUrls: ['./spares-group.component.scss']\r\n})\r\nexport class SparesGroupComponent implements OnInit {\r\n  @Input()\r\n  public sparesGroup: SparesGroup;\r\n  @Input()\r\n  public textFilter: string;\r\n  @Input()\r\n  public siteId: string;\r\n  public skuStocks: ISkuStock[] = [];\r\n  public visuallyExpanded = false;\r\n  public offset = 0;\r\n  private takeSize = 10;\r\n  public shouldGetNextSkuStocks = true;\r\n  public isGettingNextSkuStocks = false;\r\n  public maxHeight: string;\r\n\r\n  constructor(public skuService: SkuService, public elementRef: ElementRef) {}\r\n\r\n  public ngOnInit() {}\r\n\r\n  public handleRowToggleClick() {\r\n    if (this.skuStocks.length === 0 && !this.isGettingNextSkuStocks) {\r\n      this.getNextSkuStocks();\r\n    }\r\n    this.visuallyExpanded = !this.visuallyExpanded;\r\n    this.setMaxHeight();\r\n  }\r\n\r\n  public getNextSkuStocks() {\r\n    this.isGettingNextSkuStocks = true;\r\n    this.skuService\r\n      .getSkuStockForSparesGroup(\r\n        this.sparesGroup.groupId,\r\n        this.sparesGroup.subGroupId,\r\n        this.takeSize,\r\n        this.offset,\r\n        this.siteId,\r\n        this.textFilter\r\n      )\r\n      .subscribe((skus: ISkuStock[]) => {\r\n        this.skuStocks.push(...skus);\r\n        this.offset += this.takeSize;\r\n        if (skus.length < this.takeSize) {\r\n          this.shouldGetNextSkuStocks = false;\r\n        }\r\n        this.isGettingNextSkuStocks = false;\r\n        this.handleSkuStockHeightChanged();\r\n      });\r\n  }\r\n\r\n  public handleSkuStockHeightChanged(): void {\r\n    setTimeout(() => this.setMaxHeight(), 200);\r\n  }\r\n\r\n  public setMaxHeight() {\r\n    const children = this.elementRef.nativeElement.children[1].children;\r\n    let totalHeight = 0;\r\n\r\n    for (const child of children) {\r\n      totalHeight += child.getBoundingClientRect().height;\r\n    }\r\n\r\n    this.maxHeight = totalHeight + 'px';\r\n  }\r\n}\r\n","<div class=\"group-toggle\" [class.expanded]=\"visuallyExpanded\">\r\n  <h2>\r\n    {{sparesGroup.name}}\r\n  </h2>\r\n\r\n  <button class=\"row-toggle\" (click)=\"handleRowToggleClick()\">\r\n    <div>\r\n      <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 8.797 5.194\">\r\n        <path d=\"M8,0l.8.8-4.4,4.4Q2.2,3,0,.8L.8,0C.81-.014,4.394,3.625,4.394,3.625S8.006,0,8,0Z\"/>\r\n      </svg>\r\n    </div>\r\n  </button>\r\n</div>\r\n\r\n<div class=\"sku-stocks\" [class.expanded]=\"visuallyExpanded\" [style.maxHeight]=\"maxHeight\">\r\n  <div>\r\n    <app-sku-stock *ngFor=\"let skuStock of skuStocks\" [skuStock]=\"skuStock\"></app-sku-stock>\r\n  </div>\r\n  <div class=\"load-more-container\">\r\n    <button (click)=\"getNextSkuStocks()\" class=\"btn btn-link\" *ngIf=\"shouldGetNextSkuStocks && !isGettingNextSkuStocks\">Load more</button>\r\n    <div class=\"spinner\" *ngIf=\"isGettingNextSkuStocks\"></div>\r\n    <i *ngIf=\"!shouldGetNextSkuStocks\">\r\n      All stocks in the '{{sparesGroup.name}}' group have been loaded.\r\n      <span *ngIf=\"textFilter\">You may see more results by changing or removing your search query.</span>\r\n    </i>\r\n  </div>\r\n</div>\r\n","import { Component, OnInit } from '@angular/core';\r\n\r\n@Component({\r\n  selector: 'app-order-history',\r\n  templateUrl: './order-history.component.html',\r\n  styleUrls: ['./order-history.component.scss']\r\n})\r\nexport class OrderHistoryComponent implements OnInit {\r\n  constructor() {}\r\n\r\n  public ngOnInit() {}\r\n}\r\n","<app-section-header></app-section-header>\r\n","import { NgModule } from '@angular/core';\r\nimport { RouterModule, Routes } from '@angular/router';\r\nimport { PermissionGuard } from '../guards/permission.guard';\r\nimport {\r\n  IRequiredPermissions,\r\n  PermissionGroup,\r\n  SparesPermissions\r\n} from '../services';\r\nimport { LandingPageComponent } from '../shared-module/landing-page/landing-page.component';\r\nimport { StockListComponent } from './stock-list/stock-list.component';\r\nimport { OrderBasketComponent } from './order-basket/order-basket.component';\r\nimport { OrderHistoryComponent } from './order-history/order-history.component';\r\n\r\nexport const stockListRequiredPermissions: IRequiredPermissions = {\r\n  [PermissionGroup.Spares]: [SparesPermissions.CanViewStockList]\r\n};\r\n\r\nexport const basketRequiredPermissions: IRequiredPermissions = {\r\n  [PermissionGroup.Spares]: [SparesPermissions.CanAddToBasket]\r\n};\r\n\r\nexport const orderViewRequiredPermissions: IRequiredPermissions = {\r\n  [PermissionGroup.Spares]: [SparesPermissions.CanViewOrderHistory]\r\n};\r\n\r\nexport const routes: Routes = [\r\n  {\r\n    path: 'stock-list',\r\n    component: StockListComponent,\r\n    canActivate: [PermissionGuard],\r\n    data: {\r\n      permissionsRequired: stockListRequiredPermissions\r\n    }\r\n  },\r\n  {\r\n    path: '',\r\n    component: LandingPageComponent\r\n  },\r\n  {\r\n    path: 'order-basket',\r\n    component: OrderBasketComponent,\r\n    canActivate: [PermissionGuard],\r\n    data: {\r\n      permissionsRequired: basketRequiredPermissions\r\n    }\r\n  },\r\n  {\r\n    path: 'order-history',\r\n    component: OrderHistoryComponent,\r\n    canActivate: [PermissionGuard],\r\n    data: {\r\n      permissionsRequired: orderViewRequiredPermissions\r\n    }\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule]\r\n})\r\nexport class SparesRoutingModule {}\r\n","import { Injectable } from '@angular/core';\r\nimport { Basket } from '../basket/basket.types';\r\nimport { Observable } from 'rxjs';\r\nimport { IOrder } from './order.types';\r\nimport { environment } from 'src/environments/environment';\r\nimport { AuthenticationService } from '../authentication/authentication.service';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { UserProfile } from '../user-account/user';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class OrderService {\r\n  private orderUrl = `${environment.apiBaseUrl}/purchase-request`;\r\n  constructor(\r\n    private authenticationService: AuthenticationService,\r\n    private httpClient: HttpClient\r\n  ) {}\r\n\r\n  private get currentUserProfile(): UserProfile {\r\n    return this.authenticationService.currentUserProfile$.getValue();\r\n  }\r\n  public requestOrder(\r\n    basket: Basket,\r\n    organisationId: string\r\n  ): Observable<IOrder> {\r\n    const items = basket.items.map(item => ({\r\n      skuId: item.skuId,\r\n      skuDescription: item.skuDescription,\r\n      requestedByUserId: item.createdByUserId,\r\n      requestedByUserName: item.createdByUserName,\r\n      uom: item.uom,\r\n      qty: item.qty\r\n    }));\r\n\r\n    let orderLink: string = this.orderUrl.concat(\r\n      '?organisationUnitId=',\r\n      organisationId\r\n    );\r\n    const payload = {\r\n      items,\r\n      siteId: this.currentUserProfile.primarySite.id,\r\n      approvedByUserId: this.currentUserProfile.userId,\r\n      approvedByUserName: this.currentUserProfile.name,\r\n      approvedByEmailId: this.currentUserProfile.emailAddress\r\n    };\r\n    return this.httpClient.post<IOrder>(orderLink, payload);\r\n  }\r\n}\r\n","export function commaSeperatedNumberString(\r\n  number: number\r\n) {\r\n  let numberString = number.toFixed(2).toString();\r\n  let lastThreeAndDecimalValues = numberString.substring(numberString.length - 6);\r\n  const otherNumbers = numberString.substring(0, numberString.length - 6);\r\n  if (otherNumbers !== '') {\r\n    lastThreeAndDecimalValues = ',' + lastThreeAndDecimalValues;\r\n  }\r\n  numberString = otherNumbers.replace(/\\B(?=(\\d{2})+(?!\\d))/g, ',') + lastThreeAndDecimalValues;\r\n  return numberString;\r\n}\r\n\r\nexport function numberToPriceString(\r\n  price: number,\r\n  currencyGlyph = '₹',\r\n  dropThePennies = false\r\n): string {\r\n  if (!price) {\r\n    return '₹0.00';\r\n  }\r\n  let prefix = currencyGlyph;\r\n  if (price < 0) {\r\n    price = price * -1;\r\n    prefix = `- ${currencyGlyph}`;\r\n  }\r\n  let priceString = commaSeperatedNumberString(price);\r\n  if (dropThePennies && Math.floor(price) !== price) {\r\n    priceString = priceString.substring(0, priceString.length - 3);\r\n  }\r\n  return prefix + priceString;\r\n}\r\n\r\nexport function numberToPriceStringNoGlyph(\r\n  price: number,\r\n  currencyGlyph = 'Rs',\r\n  dropThePennies = false\r\n): string {\r\n  if (!price) {\r\n    return '₹0.00';\r\n  }\r\n  let prefix = currencyGlyph;\r\n  if (price < 0) {\r\n    price = price * -1;\r\n    prefix = `- ${currencyGlyph}`;\r\n  }\r\n  let priceString = commaSeperatedNumberString(price);\r\n  if (dropThePennies && Math.floor(price) !== price) {\r\n    priceString = priceString.substring(0, priceString.length - 3);\r\n  }\r\n  return prefix +' '+ priceString;\r\n}\r\n\r\nexport function randomInt(min, max) {\r\n  return Math.floor(Math.random() * (max - min + 1)) + min;\r\n}\r\n\r\nexport function numberToWords(value: any,\r\n  dropThePennies = false\r\n  ): string {\r\n\r\n  if (dropThePennies && Math.floor(value) !== value) {\r\n    const priceString: string = value.toFixed(2).toString();\r\n    value = priceString.substring(0, priceString.length - 3);\r\n  }\r\n\r\n  const units = [\r\n    '',\r\n    'one ',\r\n    'two ',\r\n    'three ',\r\n    'four ',\r\n    'five ',\r\n    'six ',\r\n    'seven ',\r\n    'eight ',\r\n    'nine ',\r\n    'ten ',\r\n    'eleven ',\r\n    'twelve ',\r\n    'thirteen ',\r\n    'fourteen ',\r\n    'fifteen ',\r\n    'sixteen ',\r\n    'seventeen ',\r\n    'eighteen ',\r\n    'nineteen '\r\n  ];\r\n\r\n  const tens = [\r\n    '',\r\n    '',\r\n    'twenty',\r\n    'thirty',\r\n    'forty',\r\n    'fifty',\r\n    'sixty',\r\n    'seventy',\r\n    'eighty',\r\n    'ninety'\r\n  ];\r\n\r\n  if (value) {\r\n    let num: any = Number(value);\r\n    if (num) {\r\n      if ((num = num.toString()).length > 9) { // Number length can not go longer then 9 digit, function will give result not more then 10 Cores\r\n        return 'Very big digit :)';\r\n      }\r\n      const n = ('000000000' + num)\r\n        .substr(-9)\r\n        .match(/^(\\d{2})(\\d{2})(\\d{2})(\\d{1})(\\d{2})$/);\r\n      if (!n) {\r\n        return '';\r\n      }\r\n      let str = '';\r\n      str +=\r\n        Number(n[1]) !== 0\r\n          ? (units[Number(n[1])] || tens[n[1][0]] + ' ' + units[n[1][1]]) + 'crore '\r\n          : '';\r\n      str +=\r\n        Number(n[2]) !== 0\r\n          ? (units[Number(n[2])] || tens[n[2][0]] + ' ' + units[n[2][1]]) + 'lakh '\r\n          : '';\r\n      str +=\r\n        Number(n[3]) !== 0\r\n          ? (units[Number(n[3])] || tens[n[3][0]] + ' ' + units[n[3][1]]) + 'thousand '\r\n          : '';\r\n      str +=\r\n        Number(n[4]) !== 0\r\n          ? (units[Number(n[4])] || tens[n[4][0]] + ' ' + units[n[4][1]]) + 'hundred '\r\n          : '';\r\n      str +=\r\n        Number(n[5]) !== 0\r\n          ? (str !== '' ? 'and ' : '') +\r\n            (units[Number(n[5])] || tens[n[5][0]] + ' ' + units[n[5][1]]) +\r\n            'rupees'\r\n          : '';\r\n      return str.toUpperCase();\r\n    } else {\r\n      return '';\r\n    }\r\n  } else {\r\n    return '';\r\n  }\r\n}\r\n","import {\r\n  Component,\r\n  HostBinding,\r\n  Input,\r\n  OnInit,\r\n  OnDestroy\r\n} from '@angular/core';\r\nimport { BasketItem } from 'src/app/services/basket/basket.types';\r\nimport {\r\n  ISkuStock,\r\n  AuthenticationService,\r\n  PermissionGroup,\r\n  BasketService,\r\n  SparesPermissions,\r\n  SkuService,\r\n  ToastService\r\n} from 'src/app/services';\r\nimport { Subscription } from 'rxjs';\r\nimport { Validators, FormGroup, FormBuilder } from '@angular/forms';\r\nimport { take } from 'rxjs/operators';\r\nimport { HttpErrorResponse } from '@angular/common/http';\r\nimport { safelyUnsubscribeFrom } from 'src/utils/observableUtils';\r\n\r\n@Component({\r\n  selector: 'app-basket-item',\r\n  templateUrl: './basket-item.component.html',\r\n  styleUrls: ['./basket-item.component.scss']\r\n})\r\nexport class BasketItemComponent implements OnInit, OnDestroy {\r\n  @Input()\r\n  public basketItem: BasketItem;\r\n  @HostBinding('class.action-in-progress')\r\n  public itemActionInProgress = false;\r\n  public quantityChangeModalVisible = false;\r\n  public qtyForm: FormGroup;\r\n  public canModifyBasket: boolean;\r\n  public skuStock: ISkuStock;\r\n  public isGettingSkuInfo = false;\r\n  public isUpdatingQty = false;\r\n  public skuInfoSubscription: Subscription;\r\n  public isCurrentUserManager = false;\r\n  public isRequestedUser = false;\r\n  public currentUserId: string;\r\n\r\n  constructor(\r\n    private basketService: BasketService,\r\n    private authenticationService: AuthenticationService,\r\n    private formBuilder: FormBuilder,\r\n    private skuService: SkuService,\r\n    private toastService: ToastService\r\n  ) {}\r\n\r\n  public ngOnInit() {\r\n    this.setPermissionBooleans();\r\n  }\r\n\r\n  public ngOnDestroy() {\r\n    safelyUnsubscribeFrom(this.skuInfoSubscription);\r\n  }\r\n\r\n  private setPermissionBooleans() {\r\n    this.authenticationService\r\n      .currentUserHasPermission({\r\n        [PermissionGroup.Spares]: [SparesPermissions.CanModifyBasket]\r\n      })\r\n      .subscribe(hasPermission => (this.canModifyBasket = hasPermission));\r\n\r\n    this.authenticationService\r\n      .currentUserIsManager()\r\n      .subscribe(isManager => (this.isCurrentUserManager = isManager));\r\n\r\n    this.currentUserId = this.authenticationService.currentUserProfile$.getValue().userId;\r\n\r\n    this.isRequestedUser =\r\n      this.currentUserId === this.basketItem.createdByUserId;\r\n  }\r\n\r\n  public handleQtyClipboard(event: ClipboardEvent) {\r\n    event.preventDefault();\r\n    return;\r\n  }\r\n\r\n  public disableRightClick(e) {\r\n    e.preventDefault();\r\n  }\r\n\r\n  public handleDeleteItem() {\r\n    if (this.isCurrentUserManager || this.isRequestedUser) {\r\n      this.itemActionInProgress = true;\r\n      this.basketService\r\n        .deleteBasketItem(\r\n          this.basketItem.skuId,\r\n          this.basketItem.createdByUserId,\r\n          this.currentUserId\r\n        )\r\n        .pipe(take(1))\r\n        .subscribe(x => x);\r\n    } else {\r\n      this.toastService.showErrorToast(\r\n        `You do not have permission to delete this basket item!`\r\n      );\r\n    }\r\n  }\r\n\r\n  public handleQtyChangeBtnClick() {\r\n    if (this.isCurrentUserManager || this.isRequestedUser) {\r\n      this.isGettingSkuInfo = true;\r\n      this.qtyForm = this.formBuilder.group({\r\n        qty: [\r\n          this.basketItem.qty,\r\n          [Validators.min(1), Validators.max(999999), Validators.required]\r\n        ]\r\n      });\r\n      this.skuInfoSubscription = this.skuService\r\n        .getSkuStockForSkuId(this.basketItem.skuId)\r\n        .subscribe(\r\n          (sku: ISkuStock[]) => {\r\n            this.isGettingSkuInfo = false;\r\n            if (sku.length > 0) {\r\n              this.skuStock = sku[0];\r\n              this.quantityChangeModalVisible = true;\r\n            } else {\r\n              const errorMessage =\r\n                'Sorry something went wrong, please try again later';\r\n              this.toastService.showErrorToast(errorMessage);\r\n            }\r\n          },\r\n          _ => {\r\n            const errorMessage =\r\n              'Sorry something went wrong, please try again later';\r\n            this.toastService.showErrorToast(errorMessage);\r\n            this.isGettingSkuInfo = false;\r\n          }\r\n        );\r\n    } else {\r\n      this.toastService.showErrorToast(\r\n        `You do not have permission to update this basket item!`\r\n      );\r\n      this.isGettingSkuInfo = false;\r\n    }\r\n  }\r\n\r\n  public handleUpdateQty() {\r\n    if (this.isUpdatingQty) {\r\n      return;\r\n    }\r\n    this.isUpdatingQty = true;\r\n    this.basketService\r\n      .updateBasketItem(this.basketItem.skuId, this.qtyForm.value.qty)\r\n      .subscribe(\r\n        _ => {\r\n          this.isUpdatingQty = false;\r\n          this.quantityChangeModalVisible = false;\r\n        },\r\n        (errorResponse: HttpErrorResponse) => {\r\n          this.isUpdatingQty = false;\r\n          const errorMessage = errorResponse.error;\r\n          this.toastService.showErrorToast(errorMessage);\r\n          return;\r\n        }\r\n      );\r\n  }\r\n\r\n  public handleQtyKeyup(event: KeyboardEvent) {\r\n    if (\r\n      event.key === 'Enter' &&\r\n      this.qtyForm.value.qty > 0 &&\r\n      this.qtyForm.value.qty.toString().length > 0 &&\r\n      this.qtyForm.value.qty >= this.skuStock.quantities.minimumOrderQuantity\r\n    ) {\r\n      event.preventDefault();\r\n      this.handleUpdateQty();\r\n    }\r\n  }\r\n\r\n  public handleQtyInputKeyDown(event) {\r\n    const qtyStringExceedsMaxLength =\r\n      this.qtyForm.value.qty.toString().length >= 6;\r\n    if (\r\n      this.qtyForm.valid &&\r\n      this.qtyForm.value.qty > 0 &&\r\n      this.qtyForm.value.qty >= this.skuStock.quantities.minimumOrderQuantity &&\r\n      event.key === 'Enter'\r\n    ) {\r\n      return;\r\n    }\r\n    if (event.key === 'Backspace' || event.key === 'Delete') {\r\n      return;\r\n    }\r\n    if (qtyStringExceedsMaxLength || isNaN(event.key) || event.keyCode === 32) {\r\n      event.preventDefault();\r\n    }\r\n  }\r\n}\r\n","<td class=\"sku-id-cell\">\r\n  <span>{{ basketItem.skuId }}</span>\r\n</td>\r\n<td class=\"description-cell\">\r\n  <span class=\"desktop-only\">{{ basketItem.skuDescription }}</span>\r\n  <span class=\"mobile-only\">{{ basketItem.skuDescription }}<br/>ID-{{ basketItem.skuId }}</span>\r\n</td>\r\n<td class=\"qty-cell\">\r\n  <button\r\n    *ngIf=\"canModifyBasket\"\r\n    (click)=\"handleQtyChangeBtnClick()\"\r\n    type=\"button\"\r\n  >\r\n    {{ basketItem.qty }}\r\n  </button>\r\n  <strong *ngIf=\"!canModifyBasket\">\r\n    {{ basketItem.qty }}\r\n  </strong>\r\n</td>\r\n<td class=\"uom-cell\">\r\n  <span>{{ basketItem.uom }}</span>\r\n</td>\r\n<td class=\"user-cell\">\r\n  <span>{{ basketItem.createdByUserName }}</span>\r\n</td>\r\n<td class=\"delete-row-cell\">\r\n  <button\r\n    (click)=\"handleDeleteItem()\"\r\n    [disabled]=\"!canModifyBasket\"\r\n    class=\"delete-btn\"\r\n  >\r\n    <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 14 18\">\r\n      <defs />\r\n      <path\r\n        d=\"M12.333 3.933L1.267 3.8c-.133.133-.4.133-.533.267A.8.8 0 0 0 .6 4.6l1.2 11.6c0 .4.267.533.667.533h8.267a.61.61 0 0 0 .666-.533l1.467-11.6a.8.8 0 0 0-.133-.533 1.343 1.343 0 0 0-.401-.134zm-2 11.6h-7.2L2.067 5.267h9.467z\"\r\n        class=\"cls-1\"\r\n        transform=\"translate(.2 1.267)\"\r\n      />\r\n      <path\r\n        d=\"M13.333 3.2h-2.666A3.739 3.739 0 0 0 6.933 0a3.607 3.607 0 0 0-3.6 3.2H.667A.63.63 0 0 0 0 3.867a.63.63 0 0 0 .667.667h12.666A.63.63 0 0 0 14 3.867a.63.63 0 0 0-.667-.667zm-6.4-1.867a2.442 2.442 0 0 1 2.4 1.867H4.667a2.407 2.407 0 0 1 2.266-1.867z\"\r\n        class=\"cls-1\"\r\n      />\r\n      <path\r\n        d=\"M5.367 13.467a.63.63 0 0 0 .667-.667V6.667A.63.63 0 0 0 5.367 6a.63.63 0 0 0-.667.667v6.267c0 .266.4.533.667.533z\"\r\n        class=\"cls-1\"\r\n        transform=\"translate(1.567 2)\"\r\n      />\r\n      <path\r\n        d=\"M3.9 13.5a.714.714 0 0 0 .667-.667l-.534-6.266a.714.714 0 0 0-.666-.667.845.845 0 0 0-.667.8l.533 6.267a.886.886 0 0 0 .667.533z\"\r\n        class=\"cls-1\"\r\n        transform=\"translate(.9 1.967)\"\r\n      />\r\n      <path\r\n        d=\"M6.942 13.475a.63.63 0 0 0 .667-.667l.533-6.267c.133-.267-.133-.533-.533-.533-.4-.133-.667.133-.667.533l-.533 6.267c-.134.401.133.667.533.667z\"\r\n        class=\"cls-1\"\r\n        transform=\"translate(2.125 1.991)\"\r\n      />\r\n    </svg>\r\n  </button>\r\n</td>\r\n<app-loading-modal\r\n  *ngIf=\"itemActionInProgress\"\r\n></app-loading-modal>\r\n<app-loading-modal\r\n  *ngIf=\"isGettingSkuInfo\"\r\n></app-loading-modal>\r\n<app-modal\r\n  *ngIf=\"quantityChangeModalVisible && skuStock && !isGettingSkuInfo\"\r\n  (modalShouldClose)=\"quantityChangeModalVisible = false\"\r\n  class=\"basket-item-modal\"\r\n  (contextmenu)=\"disableRightClick($event)\"\r\n>\r\n  <article>\r\n    <section class=\"generic-info\">\r\n      <header class=\"row\">\r\n        <div class=\"col-8\">\r\n          <h1>{{ skuStock.sparesGroupName }}</h1>\r\n        </div>\r\n        <div class=\"col-4 text-right\">\r\n          <strong>ID</strong> {{ skuStock.id }}\r\n        </div>\r\n      </header>\r\n      <div class=\"row description-row mt-4\">\r\n        <div class=\"col-12\">\r\n          <dl>\r\n            <dt>Description</dt>\r\n            <dd>{{ skuStock.description }}</dd>\r\n          </dl>\r\n        </div>\r\n      </div>\r\n    </section>\r\n    <section class=\"stock-info\">\r\n      <div class=\"row\">\r\n        <div class=\"col12\">\r\n          <h2>Order</h2>\r\n        </div>\r\n      </div>\r\n      <div class=\"info-row row\">\r\n        <div class=\"col-4\">\r\n          <dl>\r\n            <dt>In stock</dt>\r\n            <dd>{{ skuStock.quantities.inStock }}</dd>\r\n          </dl>\r\n        </div>\r\n        <div class=\"col-4\">\r\n          <dl>\r\n            <dt>Min. Required Stock</dt>\r\n            <dd>{{ skuStock.quantities.reOrderLevel }}</dd>\r\n          </dl>\r\n        </div>\r\n        <div class=\"col-4\">\r\n          <dl>\r\n            <dt>Uom</dt>\r\n            <dd>{{ skuStock.uom }}</dd>\r\n          </dl>\r\n        </div>\r\n      </div>\r\n      <div *ngIf=\"canModifyBasket\">\r\n        <div\r\n          class=\"row notice-row\"\r\n          *ngIf=\"qtyForm.value.qty < skuStock.quantities.minimumOrderQuantity\"\r\n        >\r\n          <div class=\"col-12\">\r\n            <div\r\n              *ngIf=\"\r\n                qtyForm.value.qty < skuStock.quantities.minimumOrderQuantity\r\n              \"\r\n            >\r\n              Please note, minimum order quantity for this product is\r\n              {{ skuStock.quantities.minimumOrderQuantity }} items.\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <form\r\n          class=\"row add-to-basket-row\"\r\n          [formGroup]=\"qtyForm\"\r\n          (submit)=\"handleUpdateQty()\"\r\n        >\r\n          <div class=\"col-4\">\r\n            <input\r\n              formControlName=\"qty\"\r\n              (paste)=\"handleQtyClipboard($event)\"\r\n              (contextmenu)=\"disableRightClick($event)\"\r\n              (keydown)=\"handleQtyInputKeyDown($event)\"\r\n              (keyup)=\"handleQtyKeyup($event)\"\r\n              type=\"text\"\r\n              pattern=\"[0-9]*\"\r\n              inputmode=\"text\"\r\n              ng-pattern=\"[0-9]*\"\r\n              class=\"form-control quantity-input\"\r\n              maxlength=\"6\"\r\n            />\r\n          </div>\r\n          <div class=\"col-8\">\r\n            <button\r\n              class=\"btn btn-primary btn-block\"\r\n              [disabled]=\"\r\n                qtyForm.value.qty < skuStock.quantities.minimumOrderQuantity ||\r\n                qtyForm.value.qty < 1 ||\r\n                qtyForm.invalid\r\n              \"\r\n            >\r\n              <span *ngIf=\"!isUpdatingQty\">Update quantity</span>\r\n              <div *ngIf=\"isUpdatingQty\" class=\"spinner light\"></div>\r\n            </button>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </section>\r\n  </article>\r\n</app-modal>\r\n","import { HttpErrorResponse } from '@angular/common/http';\r\nimport { Component, OnInit } from '@angular/core';\r\nimport { FormBuilder, FormGroup } from '@angular/forms';\r\nimport { Subscription } from 'rxjs';\r\nimport {\r\n  AuthenticationService,\r\n  SkuService,\r\n  SparesGroup,\r\n  ToastService\r\n} from '../../services';\r\nimport { debounceTime, filter } from 'rxjs/operators';\r\n\r\n@Component({\r\n  selector: 'app-stock-list',\r\n  templateUrl: './stock-list.component.html',\r\n  styleUrls: ['./stock-list.component.scss']\r\n})\r\nexport class StockListComponent implements OnInit {\r\n  public isLoading: Boolean = true;\r\n  public searchForm: FormGroup;\r\n  public allProductClassesOption = '';\r\n  public sparesGroups: Array<SparesGroup> = [];\r\n  public getSparesGroupSubscription: Subscription;\r\n  public siteId: string;\r\n\r\n  constructor(\r\n    public skuService: SkuService,\r\n    private formBuilder: FormBuilder,\r\n    private toastService: ToastService,\r\n    private authenticationService: AuthenticationService\r\n  ) {\r\n    this.siteId = this.authenticationService.currentUserProfile$.value.primarySite.id;\r\n    this.searchForm = this.formBuilder.group({\r\n      text: ''\r\n    });\r\n  }\r\n\r\n  public ngOnInit() {\r\n    this.getSparesGroupSubscription = this.skuService\r\n      .getSparesGroups(undefined, this.siteId)\r\n      .subscribe(\r\n        (data: Array<SparesGroup>) => {\r\n          this.sparesGroups = data;\r\n          this.isLoading = false;\r\n        },\r\n        (err: HttpErrorResponse) => {\r\n          this.toastService.showErrorToast(\r\n            `Sorry something went wrong... please try again later, ${err}`\r\n          );\r\n        }\r\n      );\r\n\r\n    this.searchForm\r\n      .get('text')\r\n      .valueChanges.pipe(\r\n        debounceTime(700),\r\n        filter(textValue => textValue.length >= 2 || textValue.length === 0)\r\n      )\r\n      .subscribe(() => this.submitSearch());\r\n  }\r\n\r\n  public get noSparesGroups(): Boolean {\r\n    return this.sparesGroups.length === 0;\r\n  }\r\n\r\n  public submitSearch() {\r\n    this.getSparesGroupSubscription.unsubscribe();\r\n    this.isLoading = true;\r\n    this.getSparesGroupSubscription = this.skuService\r\n      .getSparesGroups(this.searchForm.get('text').value, this.siteId)\r\n      .subscribe(\r\n        (data: Array<SparesGroup>) => {\r\n          this.sparesGroups = data;\r\n          this.isLoading = false;\r\n        },\r\n        (err: HttpErrorResponse) => {\r\n          this.toastService.showErrorToast(\r\n            `Sorry something went wrong... please try again later, ${err}`\r\n          );\r\n        }\r\n      );\r\n  }\r\n}\r\n","<app-section-header></app-section-header>\r\n<h1>Stock List</h1>\r\n\r\n<form [formGroup]=\"searchForm\" class=\"search-form\">\r\n  <div class=\"row\">\r\n    <div class=\"col-md-5\">\r\n      <div class=\"input-with-search-wrapper\">\r\n        <input type=\"text\" formControlName=\"text\" class=\"form-control form-control--search-prefix\" placeholder=\"Search stock by id or description\" />\r\n      </div>\r\n    </div>\r\n    <div class=\"col-md-7 d-flex justify-content-end\">\r\n      <button class=\"btn-download-csv\"  type=\"button\">\r\n        <svg viewBox=\"0 0 15.375 19.188\"><defs/><g id=\"Group_1558\" data-name=\"Group 1558\" transform=\"translate(-299.063 -288.813)\"><g id=\"Path_783\" class=\"cls-1\" data-name=\"Path 783\"><path d=\"M940.063 237.334v19.188h15.375v-14.313l-4.875-4.875h-10.5z\" class=\"cls-3\" transform=\"translate(-641 51.479)\"/><path d=\"M954.438 255.521v-12.898l-4.29-4.289h-9.085v17.187h13.375m1 1h-15.375v-19.187h10.5l4.875 4.875v14.312z\" class=\"cls-4\" transform=\"translate(-641 51.479)\"/></g><path id=\"Path_784\" d=\"M954.918 242.288h-5.043v-5.079\" class=\"cls-2\" data-name=\"Path 784\" transform=\"translate(-640.959 51.604)\"/><g id=\"Path_785\" class=\"cls-1\" data-name=\"Path 785\"><path d=\"M943.5 245.334h8.563v7.25H943.5z\" class=\"cls-3\" transform=\"translate(-641 51.479)\"/><path d=\"M951.063 251.584v-5.25H944.5v5.25h6.563m1 1H943.5v-7.25h8.563v7.25z\" class=\"cls-4\" transform=\"translate(-641 51.479)\"/></g><path id=\"Path_786\" d=\"M946.5 245.084v7.25\" class=\"cls-2\" data-name=\"Path 786\" transform=\"translate(-641.064 51.729)\"/><path id=\"Path_787\" d=\"M952.063 247.834H944\" class=\"cls-2\" data-name=\"Path 787\" transform=\"translate(-641 51.479)\"/><path id=\"Path_788\" d=\"M951.938 250.4h-8.562\" class=\"cls-2\" data-name=\"Path 788\" transform=\"translate(-640.875 51.479)\"/></g>\r\n        </svg>\r\n        <h1>CSV</h1>\r\n      </button>\r\n    </div>\r\n  </div>\r\n</form>\r\n\r\n<div class=\"spinner\" *ngIf=\"isLoading\"></div>\r\n<article *ngIf=\"!isLoading  && !noSparesGroups\">\r\n  <section class=\"spare-class\" >\r\n    <div class=\"spare-groups\">\r\n      <app-spares-group *ngFor=\"let sparesGroup of sparesGroups\" [sparesGroup]=\"sparesGroup\" [textFilter]=\"searchForm.get('text').value\" [siteId]=\"siteId\"></app-spares-group>\r\n    </div>\r\n  </section>\r\n\r\n</article>\r\n"]}